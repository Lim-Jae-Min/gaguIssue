<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ko.gagu.issue.dao.SupportDepartmentDAO">
	<select id="clientList">
		SELECT
			idx_business,
			client_type, 
			client_name, 
			client_phone_num, 
			address
		FROM client_tb 
		WHERE
		client_del = 0
		<if test="param3 != null and param3 != '' and param3 != '전체'">
           	 AND client_name LIKE CONCAT('%', #{param3}, '%')
        </if>
        LIMIT #{param2},#{param1}
        
	</select>
	
	<select id="clientListAllCount" resultType="Integer" parameterType="map">
		SELECT 
			CEIL(COUNT(*)/#{cnt}) AS pages
		FROM client_tb
		WHERE 
		client_del = 0
		<if test="param2 != null and param2 != '' and param2 != '전체'">
           	 AND client_name LIKE CONCAT('%', #{clientSearch}, '%')
        </if>
	</select>
	
	
	<insert id="clientReg">
		INSERT INTO client_tb 
			(idx_business, client_name, ceo_name, address, etc, client_type, client_phone_num) 
		VALUES 
			(#{idx_business},#{client_name},#{ceo_name},#{full_address},#{etc},#{client_type},#{client_phone_num})
	</insert>
	
	<update id="del">
		UPDATE client_tb SET client_del = 1 WHERE idx_business = #{param1}
	</update>
	
	<select id="getClient">
		SELECT * FROM client_tb ct WHERE ct.idx_business = #{param1}
	</select>
	
	<update id="clientEdit">
		UPDATE client_tb 
	    SET 
	   		idx_business = #{idx_business},
	   		client_name = #{client_name},
	   		ceo_name = #{ceo_name},
	   		address = #{full_address},
	   		etc = #{etc},
	   		client_type = #{client_type2},
	   		client_phone_num = #{client_phone_num}
	    WHERE idx_business = #{idx_business}
	</update>
	
	
	<select id="clientDetail">
		SELECT * FROM client_tb ct WHERE ct.idx_business = #{param1}
	</select>
	
</mapper>
